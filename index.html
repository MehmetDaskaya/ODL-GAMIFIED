<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Password Protector: Beat the Hacker</title>

    <style>
      :root {
        --primary: #4e54c8;
        --secondary: #8f94fb;
        --danger: #ff4757;
        --success: #2ed573;
        --warning: #ffa502;
        --dark: #2f3542;
        --light: #f1f2f6;
        --background: #1e272e;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: var(--background);
        color: var(--light);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        overflow-x: hidden;
      }

      /* Animated background */
      .background {
        position: fixed;
        width: 100vw;
        height: 100vh;
        top: 0;
        left: 0;
        z-index: -1;
        opacity: 0.3;
      }

      .cube {
        position: absolute;
        top: 80vh;
        left: 45vw;
        width: 10px;
        height: 10px;
        border: 1px solid var(--secondary);
        transform-origin: top left;
        transform: scale(0) rotate(0deg) translate(-50%, -50%);
        animation: cube 12s ease-in infinite;
      }

      .cube:nth-child(2n) {
        border-color: var(--primary);
      }

      .cube:nth-child(2) {
        animation-delay: 2s;
        left: 25vw;
        top: 40vh;
      }

      .cube:nth-child(3) {
        animation-delay: 4s;
        left: 75vw;
        top: 50vh;
      }

      .cube:nth-child(4) {
        animation-delay: 6s;
        left: 90vw;
        top: 10vh;
      }

      .cube:nth-child(5) {
        animation-delay: 8s;
        left: 10vw;
        top: 85vh;
      }

      .cube:nth-child(6) {
        animation-delay: 10s;
        left: 50vw;
        top: 10vh;
      }

      @keyframes cube {
        from {
          transform: scale(0) rotate(0deg) translate(-50%, -50%);
          opacity: 1;
        }
        to {
          transform: scale(20) rotate(960deg) translate(-50%, -50%);
          opacity: 0;
        }
      }

      header {
        padding: 2rem;
        text-align: center;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .subtitle {
        font-size: 1.2rem;
        opacity: 0.8;
      }

      main {
        max-width: 800px;
        margin: 2rem auto;
        padding: 0 1rem;
        flex: 1;
      }

      .container {
        background-color: rgba(47, 53, 66, 0.8);
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        margin: 2rem auto;
        border: 1px solid var(--primary);
        max-width: 100%;
        width: 100%;
        overflow: hidden;
        transition: max-height 0.6s ease, opacity 0.6s ease, padding 0.4s ease;
      }

      .container.collapsed .container-content {
        max-height: 0;
        opacity: 0;
        padding: 0;
        overflow: hidden;
        transition: all 0.6s ease;
      }

      .container-content {
        padding: 2rem;
        transition: all 0.6s ease;
      }

      .container-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: none;
        padding: 1rem 1.5rem;
        font-size: 1.3rem;
        font-weight: bold;
      }

      .toggle-icon {
        cursor: pointer;
        font-size: 1.5rem;
        transition: transform 0.3s ease;
      }

      .container.collapsed .toggle-icon {
        transform: rotate(-90deg);
      }

      .password-input {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .input-group {
        position: relative;
      }

      input[type="text"],
      input[type="password"] {
        width: 100%;
        padding: 1rem;
        border-radius: 5px;
        border: 2px solid var(--dark);
        background-color: rgba(47, 53, 66, 0.8);
        color: var(--light);
        font-size: 1.2rem;
        transition: all 0.3s;
      }

      input[type="text"]:focus,
      input[type="password"]:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 2px rgba(78, 84, 200, 0.3);
      }

      .toggle-password {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: var(--light);
        cursor: pointer;
        font-size: 1.2rem;
      }

      .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 5px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: bold;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 7px 14px rgba(0, 0, 0, 0.2);
      }

      .btn:active {
        transform: translateY(1px);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
      }

      .btn-block {
        display: block;
        width: 100%;
      }

      .strength-meter {
        height: 10px;
        background-color: var(--dark);
        border-radius: 5px;
        margin: 1rem 0;
        position: relative;
        overflow: hidden;
      }

      .strength-meter-fill {
        height: 100%;
        width: 0;
        border-radius: 5px;
        transition: width 0.5s ease, background-color 0.5s ease;
      }

      .strength-text {
        margin-top: 0.5rem;
        text-align: center;
        font-weight: bold;
        min-height: 24px;
      }

      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        z-index: 9999;
        color: white;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background: #2f3542;
        padding: 2rem;
        max-width: 500px;
        width: 90%;
        border-radius: 10px;
        text-align: center;
      }

      .hacker-gif {
        width: 100%;
        max-height: 200px;
        object-fit: contain;
      }

      .crack-time {
        margin-top: 20px;
        font-size: 1.5rem;
        color: var(--danger);
        font-weight: bold;
      }

      .password-tips {
        text-align: left;
        margin: 20px 0;
      }

      .tip-title {
        color: var(--secondary);
        margin-bottom: 10px;
        font-weight: bold;
      }

      .tips-list {
        margin-left: 20px;
      }

      .tips-list li {
        margin-bottom: 8px;
      }

      .strength-indicator {
        display: inline-block;
        padding: 5px 15px;
        border-radius: 5px;
        margin: 10px 0;
        font-weight: bold;
      }

      .feedback-message {
        margin: 15px 0;
        font-style: italic;
      }

      footer {
        text-align: center;
        padding: 1.5rem;
        background-color: rgba(47, 53, 66, 0.8);
        margin-top: auto;
      }

      .hearts {
        color: #ff6b81;
        animation: heartBeat 1.3s infinite ease-in-out;
        display: inline-block;
        transform-origin: center;
      }

      @keyframes heartBeat {
        0% {
          transform: scale(1);
        }
        14% {
          transform: scale(1.3);
        }
        28% {
          transform: scale(1);
        }
        42% {
          transform: scale(1.3);
        }
        70% {
          transform: scale(1);
        }
      }

      /* Animation for the hacker attacking */
      .hacker-animation {
        font-size: 2rem;
        margin: 20px 0;
        animation: hackAttack 0.5s infinite;
      }

      @keyframes hackAttack {
        0% {
          transform: translateX(-2px);
        }
        50% {
          transform: translateX(2px);
        }
        100% {
          transform: translateX(-2px);
        }
      }

      .animated-dots span {
        animation: dots 1.5s infinite;
        animation-fill-mode: both;
        font-size: 1.5rem;
      }

      .animated-dots span:nth-child(2) {
        animation-delay: 0.2s;
      }

      .animated-dots span:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes dots {
        0% {
          opacity: 0.2;
        }
        20% {
          opacity: 1;
        }
        100% {
          opacity: 0.2;
        }
      }

      /* Responsive design */
      @media (max-width: 768px) {
        header {
          padding: 1.5rem 1rem;
        }

        h1 {
          font-size: 2rem;
        }

        .container {
          padding: 1.5rem;
        }

        .modal-content {
          width: 95%;
          padding: 1rem;
        }
      }

      .info-box {
        background-color: rgba(255, 255, 255, 0.05);
        border-left: 4px solid var(--secondary);
        padding: 1rem;
        margin-bottom: 1rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.4s ease;
      }

      .info-box h3 {
        margin-bottom: 0.5rem;
        color: var(--secondary);
      }
      .info-box li {
        padding-left: 0.5rem;
        /* remove dots */
        list-style-type: none;
      }

      .info-box-content {
        overflow: hidden;
        max-height: 0;
        transition: max-height 0.6s ease;
      }

      .info-box.open .info-box-content {
        max-height: 500px;
      }

      #quizOptions li {
        list-style: none;
      }

      #quizOptions input[type="radio"] {
        margin-right: 10px;
      }

      #quizModal ul {
        padding: 0;
      }
    </style>
    <style>
      .quiz-option {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid transparent;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .quiz-option:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: var(--secondary);
      }

      .quiz-option.selected {
        border-color: var(--primary);
        background: rgba(78, 84, 200, 0.2);
      }

      .quiz-option.correct {
        border-color: var(--success);
        background: rgba(46, 213, 115, 0.2);
      }

      .quiz-option.incorrect {
        border-color: var(--danger);
        background: rgba(255, 71, 87, 0.2);
      }

      .question-item {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        border-left: 4px solid var(--secondary);
      }

      .question-item.correct {
        border-left-color: var(--success);
      }

      .question-item.incorrect {
        border-left-color: var(--danger);
      }

      .answer-status {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: bold;
        margin-bottom: 8px;
      }

      .answer-status.correct {
        background: var(--success);
        color: white;
      }

      .answer-status.incorrect {
        background: var(--danger);
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="background">
      <div class="cube"></div>
      <div class="cube"></div>
      <div class="cube"></div>
      <div class="cube"></div>
      <div class="cube"></div>
      <div class="cube"></div>
    </div>

    <header>
      <h1>üîê Password Protector</h1>
      <p class="subtitle">Can your password survive a hacker attack?</p>
    </header>

    <main>
      <div class="container">
        <div class="container-header">
          <span>Step 1: Learn About Password Security </span>
          <span class="toggle-icon" onclick="toggleContainer(this)">‚ñº</span>
        </div>
        <div class="container-content">
          <div class="info-box">
            <h3>üîê Why Password Security Matters</h3>
            <div class="info-box-content">
              <p>
                Over 80% of data breaches result from weak or stolen
                passwords...
              </p>
            </div>
          </div>

          <div class="info-box">
            <h3>‚ö†Ô∏è Risks of Weak Passwords</h3>
            <ul>
              <li>üîì Identity theft and financial fraud</li>
              <li>üîÅ Account takeover across platforms</li>
              <li>üé≠ Social engineering attacks</li>
            </ul>
          </div>

          <div class="info-box">
            <h3>üìö What You Will Learn</h3>
            <p>In this module, you'll learn how to:</p>
            <ul>
              <li>Create strong and memorable passwords</li>
              <li>Test your password strength</li>
              <li>Follow best practices for managing passwords</li>
            </ul>
          </div>

          <div class="info-box">
            <h3>üîç Check If Your Password Was Leaked</h3>
            <p>
              Use
              <a
                href="https://haveibeenpwned.com"
                target="_blank"
                style="color: var(--secondary); text-decoration: underline"
                >Have I Been Pwned</a
              >
              to check if your passwords or email addresses have been part of
              any known data breaches.
            </p>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="container-header">
          <span>Step 2: Challenge the Hacker </span>
          <span class="toggle-icon" onclick="toggleContainer(this)">‚ñº</span>
        </div>
        <div class="container-content">
          <img
            src="assets/hacker/1.png"
            alt="Hacker Animation"
            class="hacker-gif"
          />
          <p style="text-align: center; margin-bottom: 20px">
            Create a strong password that's hard to crack. The longer it takes
            the hacker to crack your password, the better your score!
          </p>

          <div class="password-input">
            <div class="input-group">
              <input
                type="password"
                id="passwordInput"
                placeholder="Type your password here..."
                autocomplete="off"
              />
              <button class="toggle-password" id="togglePassword">üëÅÔ∏è</button>
            </div>

            <div class="strength-text" id="strengthText"></div>

            <button class="btn btn-block" id="testButton">
              Test Your Password
            </button>
          </div>

          <div class="modal" id="hackingModal">
            <div class="modal-content">
              <div id="hackerAnimation">
                <div class="hacker-animation">üë®‚Äçüíª</div>
                <p>
                  Hacker is attacking your password<span class="animated-dots"
                    ><span>.</span><span>.</span><span>.</span></span
                  >
                </p>
              </div>

              <div id="resultContent" style="display: none">
                <h3>Password Analysis Results</h3>
                <div class="strength-indicator" id="strengthIndicator">
                  Moderate
                </div>
                <div class="strength-meter">
                  <div class="strength-meter-fill" id="strengthMeterFill"></div>
                </div>
                <div class="crack-time" id="crackTimeDisplay">
                  Cracked in: <span id="crackTime">0</span>
                </div>

                <div class="feedback-message" id="feedbackMessage">
                  Your password could be stronger!
                </div>

                <div class="password-tips">
                  <h4 class="tip-title">How to improve your password:</h4>
                  <ul class="tips-list" id="tipsList">
                    <!-- Tips will be populated dynamically -->
                  </ul>
                </div>

                <button class="btn btn-block" id="newPasswordBtn">
                  Test A New Password
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Replace the existing quiz container section with this: -->
      <div class="container quiz-container collapsed" id="step3Container">
        <div class="container-header">
          <span>Step 3: Take the Quiz</span>
          <span class="toggle-icon" onclick="toggleContainer(this)">‚ñº</span>
        </div>
        <div class="container-content" style="text-align: center">
          <p>Test your knowledge with a cybersecurity quiz!</p>
          <div id="quizProgress" style="display: none; margin: 15px 0">
            <div
              style="
                background: var(--dark);
                height: 8px;
                border-radius: 4px;
                overflow: hidden;
              "
            >
              <div
                id="progressBar"
                style="
                  background: var(--secondary);
                  height: 100%;
                  width: 0%;
                  transition: width 0.3s;
                "
              ></div>
            </div>
            <p style="margin-top: 8px; font-size: 0.9rem">
              Question <span id="currentQ">1</span> of
              <span id="totalQ">20</span>
            </p>
          </div>
          <button class="btn btn-block" onclick="startQuiz()">
            Start Quiz
          </button>
        </div>
      </div>

      <!-- Replace the existing quiz modal with this: -->
      <div class="modal" id="quizModal">
        <div class="modal-content" style="max-width: 700px">
          <!-- Quiz Question View -->
          <div id="quizQuestionView">
            <h3 id="quizQuestion">Loading...</h3>
            <ul id="quizOptions" style="text-align: left; margin: 20px 0"></ul>
            <div
              id="quizFeedback"
              style="
                display: none;
                margin: 15px 0;
                padding: 15px;
                border-radius: 5px;
              "
            ></div>
            <div
              style="
                display: flex;
                justify-content: space-between;
                margin-top: 1rem;
              "
            >
              <button
                class="btn"
                id="prevBtn"
                onclick="prevQuestion()"
                disabled
              >
                ‚Üê Back
              </button>
              <button
                class="btn"
                id="nextBtn"
                onclick="nextQuestion()"
                disabled
              >
                Next ‚Üí
              </button>
            </div>
            <button
              class="btn btn-block"
              style="margin-top: 1rem"
              onclick="submitQuiz()"
            >
              Submit Quiz
            </button>
          </div>

          <!-- Quiz Results View -->
          <div id="quizResultsView" style="display: none">
            <h2 style="color: var(--secondary); margin-bottom: 20px">
              üéØ Quiz Results
            </h2>

            <div
              style="
                background: rgba(255, 255, 255, 0.1);
                padding: 20px;
                border-radius: 10px;
                margin-bottom: 20px;
              "
            >
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 15px;
                "
              >
                <span style="font-size: 1.2rem">Your Score:</span>
                <span
                  id="finalScore"
                  style="
                    font-size: 2rem;
                    font-weight: bold;
                    color: var(--success);
                  "
                  >0/20</span
                >
              </div>
              <div
                style="
                  background: var(--dark);
                  height: 12px;
                  border-radius: 6px;
                  overflow: hidden;
                "
              >
                <div
                  id="scoreBar"
                  style="
                    background: var(--success);
                    height: 100%;
                    width: 0%;
                    transition: width 1s ease;
                  "
                ></div>
              </div>
              <p
                id="scoreMessage"
                style="margin-top: 10px; font-style: italic"
              ></p>
            </div>

            <div style="text-align: left">
              <h3 style="color: var(--secondary); margin-bottom: 15px">
                üìã Question Review
              </h3>
              <div
                id="questionReview"
                style="max-height: 400px; overflow-y: auto; padding-right: 10px"
              ></div>
            </div>

            <div style="margin-top: 20px">
              <button
                class="btn"
                onclick="retakeQuiz()"
                style="margin-right: 10px"
              >
                üîÑ Retake Quiz
              </button>
              <button class="btn" onclick="closeQuiz()">‚úÖ Finish</button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>
        Created with <span class="hearts">‚ù§Ô∏è</span> for better cybersecurity |
        Open and Distance Learning 2025
      </p>
    </footer>

    <script>
      // DOM Elements
      const passwordInput = document.getElementById("passwordInput");
      const togglePassword = document.getElementById("togglePassword");
      const strengthMeterFill = document.getElementById("strengthMeterFill");
      const strengthText = document.getElementById("strengthText");
      const testButton = document.getElementById("testButton");
      const hackingModal = document.getElementById("hackingModal");
      const hackerAnimation = document.getElementById("hackerAnimation");
      const resultContent = document.getElementById("resultContent");
      const strengthIndicator = document.getElementById("strengthIndicator");
      const crackTime = document.getElementById("crackTime");
      const feedbackMessage = document.getElementById("feedbackMessage");
      const tipsList = document.getElementById("tipsList");
      const newPasswordBtn = document.getElementById("newPasswordBtn");

      // Variables
      let currentPasswordScore = 0;
      let passwordCharTypes = 0;

      // Initialize the application
      function init() {
        addEventListeners();
      }

      function addEventListeners() {
        let debounceTimer;
        passwordInput.addEventListener("input", () => {
          clearTimeout(debounceTimer);
          debounceTimer = setTimeout(checkPasswordStrength, 200);
        });

        togglePassword.addEventListener("click", togglePasswordVisibility);
        testButton.addEventListener("click", startHackerChallenge);
        newPasswordBtn.addEventListener("click", resetChallenge);
      }

      function checkPasswordStrength() {
        const value = passwordInput.value;
        if (!value.trim()) {
          strengthMeterFill.style.width = "0";
          strengthText.textContent = "";
          return;
        }

        let score = 0;
        let types = 0;

        const hasLower = /[a-z]/.test(value);
        const hasUpper = /[A-Z]/.test(value);
        const hasNumber = /\d/.test(value);
        const hasSymbol = /[^A-Za-z0-9]/.test(value);
        const lengthBonus = value.length >= 12 ? 1 : 0;

        types = [hasLower, hasUpper, hasNumber, hasSymbol].filter(
          Boolean
        ).length;
        passwordCharTypes = types;

        score = value.length * 5 + types * 10 + lengthBonus * 10;
        score = Math.min(score, 100);

        currentPasswordScore = score;
        strengthMeterFill.style.width = `${score}%`;
        strengthMeterFill.style.backgroundColor =
          score < 40 ? "#ff4757" : score < 70 ? "#ffa502" : "#2ed573";
        strengthText.textContent =
          score < 40 ? "Weak" : score < 70 ? "Moderate" : "Strong";
      }

      function togglePasswordVisibility() {
        passwordInput.type =
          passwordInput.type === "password" ? "text" : "password";
      }

      function startHackerChallenge() {
        const password = passwordInput.value.trim();
        if (!password) {
          alert("Please enter a password first!");
          return;
        }
        document.getElementById("step3Container").classList.remove("collapsed");
        quizTried = true;

        // Show the modal
        hackingModal.style.display = "flex";
        hackerAnimation.innerHTML = `
        <img src="assets/hacker/1.png" class="hacker-gif" id="hackerImg" />
      `;
        hackerAnimation.style.display = "block";
        resultContent.style.display = "none";

        // Change to second image after 2 seconds
        setTimeout(() => {
          const hackerImg = document.getElementById("hackerImg");
          if (hackerImg) hackerImg.src = "assets/hacker/2.png";
        }, 2000);

        // After 5 seconds total, show the result
        setTimeout(() => {
          showHackingResults(password);
        }, 5000);
      }

      function showHackingResults(password) {
        const crackTimeSeconds = calculateCrackTime(password);
        const formattedTime = formatCrackTime(crackTimeSeconds);

        // Determine success or fail
        const isSuccess = crackTimeSeconds / 60 <= 5; // under 5 mins = success

        // Show final result image
        hackerAnimation.innerHTML = `
        <img src="assets/hacker/${
          isSuccess ? "3" : "4"
        }.png" class="hacker-gif" />
      `;

        // Show result content
        resultContent.style.display = "block";
        crackTime.textContent = formattedTime;

        strengthIndicator.textContent =
          currentPasswordScore < 40
            ? "Weak"
            : currentPasswordScore < 70
            ? "Moderate"
            : "Strong";

        strengthIndicator.style.backgroundColor =
          currentPasswordScore < 40
            ? "#ff4757"
            : currentPasswordScore < 70
            ? "#ffa502"
            : "#2ed573";

        if (currentPasswordScore < 40) {
          feedbackMessage.textContent =
            "Your password is too weak and was easily cracked!";
        } else if (currentPasswordScore < 70) {
          feedbackMessage.textContent =
            "Your password provides moderate protection, but could be stronger.";
        } else {
          feedbackMessage.textContent =
            "Great job! Your password is strong and difficult to crack.";
        }

        generatePasswordTips(password);
      }

      function calculateCrackTime(password) {
        // This is a simplified model for educational purposes
        const length = password.length;
        const charsetSize = calculateCharsetSize();

        // Basic formula: charsetSize^length / guesses per second
        // Assuming 1 billion guesses per second for a typical hacker
        const guessesPerSecond = 1000000000;

        // Calculation with entropy estimation
        let entropy = length * Math.log2(charsetSize);
        let seconds = Math.pow(2, entropy) / guessesPerSecond;

        // Add some randomness to make it more realistic
        seconds = seconds * (0.8 + Math.random() * 0.4);

        // Minimum and maximum values
        return Math.max(0.1, Math.min(seconds, 9.99e20));
      }

      function calculateCharsetSize() {
        // Calculate the character set size based on password content
        const hasLower = /[a-z]/.test(passwordInput.value);
        const hasUpper = /[A-Z]/.test(passwordInput.value);
        const hasNumber = /\d/.test(passwordInput.value);
        const hasSymbol = /[^A-Za-z0-9]/.test(passwordInput.value);

        let size = 0;
        if (hasLower) size += 26;
        if (hasUpper) size += 26;
        if (hasNumber) size += 10;
        if (hasSymbol) size += 33;

        return size > 0 ? size : 26; // Default to lowercase if somehow none matched
      }

      function formatCrackTime(seconds) {
        if (seconds < 1) return `${(seconds * 1000).toFixed(0)} milliseconds`;
        if (seconds < 60) return `${seconds.toFixed(1)} seconds`;
        if (seconds < 3600) return `${(seconds / 60).toFixed(1)} minutes`;
        if (seconds < 86400) return `${(seconds / 3600).toFixed(1)} hours`;
        if (seconds < 2592000) return `${(seconds / 86400).toFixed(1)} days`;
        if (seconds < 31536000)
          return `${(seconds / 2592000).toFixed(1)} months`;
        if (seconds < 315360000)
          return `${(seconds / 31536000).toFixed(1)} years`;
        if (seconds < 3153600000)
          return `${(seconds / 31536000).toFixed(0)} years`;
        return "over 100 years";
      }

      function generatePasswordTips(password) {
        tipsList.innerHTML = "";
        const tips = [];

        // Length check
        if (password.length < 12) {
          tips.push(
            "Make your password longer (aim for at least 12 characters)"
          );
        }

        // Character variety check
        const hasLower = /[a-z]/.test(password);
        const hasUpper = /[A-Z]/.test(password);
        const hasNumber = /\d/.test(password);
        const hasSymbol = /[^A-Za-z0-9]/.test(password);

        if (!hasLower) tips.push("Add lowercase letters (a-z)");
        if (!hasUpper) tips.push("Add uppercase letters (A-Z)");
        if (!hasNumber) tips.push("Add numbers (0-9)");
        if (!hasSymbol) tips.push("Add special characters (!@#$%^&*)");

        // Common patterns check
        if (/(\w)\1{2,}/.test(password)) {
          tips.push("Avoid repeated characters (like 'aaa' or '111')");
        }

        if (/^(qwerty|asdfgh|zxcvbn|12345|password)/i.test(password)) {
          tips.push("Avoid common keyboard patterns and words like 'password'");
        }

        // If password is already strong
        if (tips.length === 0) {
          tips.push(
            "Your password is already strong! Remember to use different passwords for different accounts."
          );
        }

        // Add tips to the list
        tips.forEach((tip) => {
          const li = document.createElement("li");
          li.textContent = tip;
          tipsList.appendChild(li);
        });
      }

      function resetChallenge() {
        hackingModal.style.display = "none";
        passwordInput.value = "";
        strengthMeterFill.style.width = "0";
        strengthText.textContent = "";
        currentPasswordScore = 0;
      }

      window.addEventListener("DOMContentLoaded", init);
      function toggleContainer(icon) {
        const container = icon.closest(".container");
        container.classList.toggle("collapsed");
      }
    </script>

    <!-- Data for questions -->
    <script id="quizData" type="application/json">
      [
        {
          "id": 1,
          "question": "Which of the following is a best practice for creating secure passwords?",
          "options": [
            "A) Using a dictionary word with some numbers",
            "B) Choosing a password you can type fast",
            "C) Using a unique password for each account",
            "D) Including your phone number"
          ],
          "correct": "C",
          "explanation": "Best practice includes using unique, strong passwords per account to prevent mass compromise."
        },
        {
          "id": 2,
          "question": "What is a common method hackers use to crack weak passwords quickly?",
          "options": [
            "A) CAPTCHA solving",
            "B) Brute-force attacks",
            "C) Email phishing",
            "D) Wi-Fi jamming"
          ],
          "correct": "B",
          "explanation": "Brute-force attacks involve trying all possible combinations of characters until the correct password is found. Weak or short passwords are especially vulnerable."
        },
        {
          "id": 3,
          "question": "What is the recommended minimum length for a secure password, according to cybersecurity experts?",
          "options": [
            "A) 4 characters",
            "B) 6 characters",
            "C) 8 characters",
            "D) 12 characters or more"
          ],
          "correct": "D",
          "explanation": "Longer passwords (12+ characters) significantly increase entropy, making them much harder to crack through brute-force or dictionary attacks."
        },
        {
          "id": 4,
          "question": "Which of the following is the safest way to store your passwords?",
          "options": [
            "A) Writing them in a notebook",
            "B) Saving them in your browser",
            "C) Using a trusted password manager",
            "D) Memorizing one password and reusing it"
          ],
          "correct": "C",
          "explanation": "A reputable password manager encrypts and securely stores your passwords, generating strong, unique ones for each account."
        },
        {
          "id": 5,
          "question": "What is ‚Äúphishing‚Äù in the context of cybersecurity?",
          "options": [
            "A) Using AI to guess passwords",
            "B) Tricking users into revealing personal information through fake websites or emails",
            "C) Hacking into social media profiles using brute-force",
            "D) Sharing passwords with friends over encrypted chat"
          ],
          "correct": "B",
          "explanation": "Phishing is a common cyberattack that deceives users into revealing sensitive information like passwords by pretending to be a trustworthy source."
        },
        {
          "id": 6,
          "question": "Which factor does crack time depend on most?",
          "options": [
            "A) Whether you can remember the password",
            "B) How fast you type it",
            "C) The password's entropy",
            "D) Whether it's been used before"
          ],
          "correct": "C",
          "explanation": "Crack time is calculated using entropy, which measures password randomness and complexity."
        },
        {
          "id": 7,
          "question": "What is the danger of reusing the same password on multiple sites?",
          "options": [
            "A) It makes typing easier",
            "B) One compromised account can lead to many breaches",
            "C) It improves memory",
            "D) It's safer with 2FA"
          ],
          "correct": "B",
          "explanation": "If one reused password is leaked, attackers can try it on other platforms to compromise multiple accounts."
        },
        {
          "id": 8,
          "question": "What kind of passwords are easiest for attackers to guess?",
          "options": [
            "A) Random strings of symbols and letters",
            "B) Long sentences with random punctuation",
            "C) Keyboard patterns like '123456' or 'qwerty'",
            "D) Passphrases using unrelated words"
          ],
          "correct": "C",
          "explanation": "Attackers use pattern recognition and dictionaries; common sequences like '123456' are guessed instantly."
        },
        {
          "id": 9,
          "question": "Why is adding symbols to your password important?",
          "options": [
            "A) It looks cool",
            "B) It satisfies password requirements",
            "C) It increases character variety, raising entropy",
            "D) It's easier to remember"
          ],
          "correct": "C",
          "explanation": "Symbols expand the character set, which increases the total number of possible combinations, making your password harder to crack."
        },
        {
          "id": 10,
          "question": "Which of the following tools helps manage strong, unique passwords safely?",
          "options": [
            "A) Spreadsheet software",
            "B) Physical notebook",
            "C) Password manager",
            "D) Sticky notes"
          ],
          "correct": "C",
          "explanation": "A password manager stores and generates complex passwords securely using encryption, reducing the need to memorize them."
        },
        {
          "id": 11,
          "question": "What does \"password entropy\" refer to?",
          "options": [
            "A) The number of times a password has been used",
            "B) The complexity and unpredictability of a password",
            "C) How fast you can type your password",
            "D) The number of symbols used"
          ],
          "correct": "B",
          "explanation": "Entropy measures randomness and complexity. High entropy means a password is harder to guess or brute-force."
        },
        {
          "id": 12,
          "question": "Which of the following passwords has the highest entropy?",
          "options": [
            "A) Password123",
            "B) !Q2w#E4r",
            "C) iloveyou2024",
            "D) sunshine!"
          ],
          "correct": "B",
          "explanation": "!Q2w#E4r uses a mix of characters, symbols, and cases, making it more complex and less predictable than the others."
        },
        {
          "id": 13,
          "question": "What is the primary purpose of two-factor authentication (2FA)?",
          "options": [
            "A) To back up your password in case you forget it",
            "B) To limit internet access",
            "C) To provide an extra layer of security by requiring a second verification step",
            "D) To automatically change your password every month"
          ],
          "correct": "C",
          "explanation": "2FA requires a second factor (like a phone code) in addition to your password, making unauthorized access more difficult."
        },
        {
          "id": 14,
          "question": "Which type of password is MOST vulnerable to dictionary attacks?",
          "options": [
            "A) R@!8v7Xn",
            "B) 123456",
            "C) qwertyuiop",
            "D) sunshine"
          ],
          "correct": "D",
          "explanation": "Common words like \"sunshine\" are often found in dictionaries used by attackers, making them easier to crack."
        },
        {
          "id": 15,
          "question": "What happens when a password is \"hashed\"?",
          "options": [
            "A) It is turned into a reversible string",
            "B) It‚Äôs encrypted and stored securely",
            "C) It is converted into a fixed-length, unreadable string using an algorithm",
            "D) It‚Äôs saved in plain text for later use"
          ],
          "correct": "C",
          "explanation": "Hashing transforms a password into an unreadable format. Good systems store only hashed passwords, not the actual text."
        },
        {
          "id": 16,
          "question": "How often should you ideally change your passwords for important accounts?",
          "options": [
            "A) Every week",
            "B) Every 2‚Äì3 years",
            "C) Only when you forget them",
            "D) Every few months or after a suspected breach"
          ],
          "correct": "D",
          "explanation": "While frequent changes aren‚Äôt always required, changing passwords after breaches or periodically helps reduce risk."
        },
        {
          "id": 17,
          "question": "What is the risk of using personal info (like birthdays or names) in passwords?",
          "options": [
            "A) It makes the password too long",
            "B) It helps you remember passwords better",
            "C) It increases the risk of social engineering attacks",
            "D) There is no risk"
          ],
          "correct": "C",
          "explanation": "Hackers can use publicly available info (like social media) to guess passwords with personal data."
        },
        {
          "id": 18,
          "question": "Which of the following is a false statement about password managers?",
          "options": [
            "A) They can generate strong, random passwords",
            "B) They allow you to use the same password for every account",
            "C) They securely store login credentials",
            "D) They often require a master password to access"
          ],
          "correct": "B",
          "explanation": "Password managers encourage unique passwords per site; reusing passwords defeats their purpose."
        },
        {
          "id": 19,
          "question": "What does a \"credential stuffing attack\" involve?",
          "options": [
            "A) Randomly trying millions of passwords",
            "B) Using leaked usernames and passwords from one site to access others",
            "C) Stealing passwords via keyloggers",
            "D) Encrypting your passwords and asking for ransom"
          ],
          "correct": "B",
          "explanation": "In credential stuffing, attackers use leaked login info from one site to attempt access to other accounts."
        },
        {
          "id": 20,
          "question": "Which behavior is MOST likely to improve your online security long-term?",
          "options": [
            "A) Using passwords that are easy to type quickly",
            "B) Writing down all passwords in a personal notebook",
            "C) Using a different, strong password for every site and enabling 2FA",
            "D) Sticking to the same password as long as you remember it"
          ],
          "correct": "C",
          "explanation": "Unique, strong passwords + 2FA = strong defense. Repetition or physical notes may leave you exposed."
        }
      ]
    </script>
    <!-- Replace the existing quiz JavaScript with this: -->
    <script>
      // Quiz functionality
      let quizData = JSON.parse(
        document.getElementById("quizData").textContent
      );
      let quizIndex = 0;
      let quizTried = false;
      let userAnswers = [];
      let quizStarted = false;
      let selectedAnswer = null;

      function startQuiz() {
        document.getElementById("quizModal").style.display = "flex";
        document.getElementById("quizProgress").style.display = "block";
        document.getElementById("quizQuestionView").style.display = "block";
        document.getElementById("quizResultsView").style.display = "none";

        quizIndex = 0;
        userAnswers = [];
        quizStarted = true;
        selectedAnswer = null;

        updateProgress();
        renderQuestion();
      }

      function updateProgress() {
        const progress = ((quizIndex + 1) / quizData.length) * 100;
        document.getElementById("progressBar").style.width = progress + "%";
        document.getElementById("currentQ").textContent = quizIndex + 1;
        document.getElementById("totalQ").textContent = quizData.length;
      }

      function renderQuestion() {
        const q = quizData[quizIndex];
        document.getElementById("quizQuestion").textContent = `Question ${
          quizIndex + 1
        }: ${q.question}`;

        const optionsList = document.getElementById("quizOptions");
        const feedback = document.getElementById("quizFeedback");

        optionsList.innerHTML = "";
        feedback.style.display = "none";
        selectedAnswer = null;

        // Get user's previous answer for this question
        const previousAnswer = userAnswers[quizIndex];

        q.options.forEach((opt, i) => {
          const li = document.createElement("li");
          li.className = "quiz-option";
          li.style.listStyle = "none";

          const optionLetter = opt.charAt(0); // A, B, C, D
          const isSelected = previousAnswer === optionLetter;

          if (isSelected) {
            li.classList.add("selected");
            selectedAnswer = optionLetter;
          }

          li.innerHTML = `<label style="cursor: pointer; display: block;">
            <input type="radio" name="quizOption" value="${optionLetter}" style="margin-right: 10px;" ${
            isSelected ? "checked" : ""
          }>
            ${opt}
          </label>`;

          li.addEventListener("click", () => selectAnswer(optionLetter, li));
          optionsList.appendChild(li);
        });

        updateNavigationButtons();
      }

      function selectAnswer(answer, element) {
        // Remove previous selection
        document.querySelectorAll(".quiz-option").forEach((opt) => {
          opt.classList.remove("selected");
        });

        // Add selection to clicked option
        element.classList.add("selected");
        element.querySelector("input").checked = true;

        selectedAnswer = answer;
        userAnswers[quizIndex] = answer;

        updateNavigationButtons();
      }

      function updateNavigationButtons() {
        const prevBtn = document.getElementById("prevBtn");
        const nextBtn = document.getElementById("nextBtn");

        prevBtn.disabled = quizIndex === 0;
        nextBtn.disabled = !selectedAnswer || quizIndex === quizData.length - 1;

        // Update button text for last question
        if (quizIndex === quizData.length - 1) {
          nextBtn.style.display = "none";
        } else {
          nextBtn.style.display = "inline-block";
        }
      }

      function prevQuestion() {
        if (quizIndex > 0) {
          quizIndex--;
          updateProgress();
          renderQuestion();
        }
      }

      function nextQuestion() {
        if (quizIndex < quizData.length - 1 && selectedAnswer) {
          quizIndex++;
          selectedAnswer = null;
          updateProgress();
          renderQuestion();
        }
      }

      function submitQuiz() {
        // Check if all questions are answered
        const unansweredQuestions = [];
        for (let i = 0; i < quizData.length; i++) {
          if (!userAnswers[i]) {
            unansweredQuestions.push(i + 1);
          }
        }

        if (unansweredQuestions.length > 0) {
          alert(
            `Please answer all questions before submitting. Missing: Question(s) ${unansweredQuestions.join(
              ", "
            )}`
          );
          return;
        }

        showResults();
      }

      function showResults() {
        document.getElementById("quizQuestionView").style.display = "none";
        document.getElementById("quizResultsView").style.display = "block";

        // Calculate score
        let correctAnswers = 0;
        userAnswers.forEach((answer, index) => {
          if (answer === quizData[index].correct) {
            correctAnswers++;
          }
        });

        const percentage = Math.round((correctAnswers / quizData.length) * 100);

        // Update score display
        document.getElementById(
          "finalScore"
        ).textContent = `${correctAnswers}/${quizData.length}`;
        document.getElementById("scoreBar").style.width = percentage + "%";

        // Score message
        let message = "";
        let scoreColor = "";
        if (percentage >= 90) {
          message = "üèÜ Excellent! You're a cybersecurity expert!";
          scoreColor = "var(--success)";
        } else if (percentage >= 70) {
          message = "üëç Great job! You have solid cybersecurity knowledge.";
          scoreColor = "var(--success)";
        } else if (percentage >= 50) {
          message = "üìö Good effort! Review the explanations to improve.";
          scoreColor = "var(--success)";
        } else {
          message = "üîÑ Keep learning! Cybersecurity takes practice.";
          scoreColor = "var(--success)";
        }

        document.getElementById("scoreMessage").textContent = message;
        document.getElementById("scoreBar").style.background =
          percentage >= 70
            ? "var(--success)"
            : percentage >= 50
            ? "var(--warning)"
            : "var(--danger)";

        // Generate question review
        generateQuestionReview(correctAnswers);
      }

      function generateQuestionReview(correctAnswers) {
        const reviewContainer = document.getElementById("questionReview");
        reviewContainer.innerHTML = "";

        quizData.forEach((q, index) => {
          const userAnswer = userAnswers[index];
          const isCorrect = userAnswer === q.correct;

          const questionDiv = document.createElement("div");
          questionDiv.className = `question-item ${
            isCorrect ? "correct" : "incorrect"
          }`;

          questionDiv.innerHTML = `
            <div class="answer-status ${isCorrect ? "correct" : "incorrect"}">
              ${isCorrect ? "‚úÖ Correct" : "‚ùå Incorrect"}
            </div>
            <h4 style="margin-bottom: 8px;">Question ${index + 1}: ${
            q.question
          }</h4>
            <p style="margin-bottom: 8px;"><strong>Your Answer:</strong> ${
              userAnswer || "Not answered"
            }</p>
            <p style="margin-bottom: 8px;"><strong>Correct Answer:</strong> ${
              q.correct
            }</p>
            <p style="font-style: italic; color: #ccc;"><strong>Explanation:</strong> ${
              q.explanation
            }</p>
          `;

          reviewContainer.appendChild(questionDiv);
        });
      }

      function retakeQuiz() {
        startQuiz();
      }

      function closeQuiz() {
        document.getElementById("quizModal").style.display = "none";
        quizIndex = 0;
        userAnswers = [];
        quizStarted = false;
        selectedAnswer = null;
      }

      // Keep the existing openQuiz function for backward compatibility
      function openQuiz() {
        startQuiz();
      }
    </script>
  </body>
</html>
